<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Fottufy - Plataforma para Fotógrafos</title>
    <!-- Tag base para garantir que todas as rotas relativas comecem da raiz -->
    <base href="/" />
    <!-- Script de suporte para garantir que o MIME type esteja correto -->
    <script>
      // Script de inicialização para garantir que a aplicação carregue corretamente
      (function() {
        // Verifica se o token de redefinição de senha está presente na URL ou no localStorage
        const urlParams = new URLSearchParams(window.location.search);
        const resetToken = urlParams.get('token');

        if (resetToken) {
          console.log("Token detectado na URL:", resetToken);
          try {
            // Se estamos em uma página que precisa do token, armazena-o
            if (window.location.pathname.includes('/reset-password') || 
                window.location.pathname.includes('/create-password')) {
              const storageKey = window.location.pathname.includes('/reset-password') 
                ? 'passwordResetToken' 
                : 'passwordCreateToken';
              localStorage.setItem(storageKey, resetToken);
              console.log(`Token salvo no localStorage como ${storageKey}`);
            }
          } catch (e) {
            console.error("Erro ao salvar token:", e);
          }
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script src="https://replit.com/public/js/replit-dev-banner.js"></script>

    <!-- Botão flutuante do WhatsApp -->
    <a
      id="whatsapp-button"
      href="https://wa.me/5583993256916?text=Olá,%20quero%20saber%20mais%20sobre%20a%20plataforma!"
      style="
        position: fixed;
        bottom: 24px;
        right: 24px;
        z-index: 9999;
        background-color: #25d366;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      "
      target="_blank"
      rel="noopener"
      title="Fale conosco no WhatsApp"
    >
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp" width="34" height="34" style="filter: invert(1);" />
    </a>

    <!-- Script para esconder o botão do WhatsApp na página project-view e project -->
    <script>
      (function() {
        function toggleWhatsAppButton() {
          const whatsappButton = document.getElementById('whatsapp-button');
          if (whatsappButton) {
            // Esconde o botão se estiver na página project-view ou project
            if (window.location.pathname.includes('/project-view/') || 
                window.location.pathname.includes('/project/')) {
              whatsappButton.style.display = 'none';
            } else {
              whatsappButton.style.display = 'flex';
            }
          }
        }

        // Executa quando a página carrega
        toggleWhatsAppButton();

        // Monitora mudanças de rota (para SPAs)
        let currentPath = window.location.pathname;
        setInterval(function() {
          if (window.location.pathname !== currentPath) {
            currentPath = window.location.pathname;
            toggleWhatsAppButton();
          }
        }, 100);
      })();
    </script>

  </body>
</html>